---
layout:     post 
title:      "五、关于子查询的优化"
subtitle:   "子查询分类，子查询执行原理，子查询优化"
date:       2020-10-29
tags:
- 中间件
- MySQL
categories:
- 中间件
---

# 子查询分类

两种写法：

```sql
SELECT * FROM t1 WHERE a IN (SELECT a FROM t2);
SELECT * FROM (SELECT * FROM t1) AS t;
```

## 按返回结果集区分

### 1. 标量子查询

只返回一个单一值的子查询称之为标量子查询。
```sql
SELECT * FROM t1 WHERE a IN (SELECT MAX(a) FROM t2);
```

### 2. 行子查询

只返回一条记录的子查询，不过这条记录需要包含多个列。
```sql
SELECT * FROM t1 WHERE (a, b) = (select a, b FROM t2 LIMIT 1);
```

### 3. 列子查询

返回一个列的数据的子查询，包含多条记录。
```sql
SELECT * FROM t1 WHERE a IN (SELECT a FROM t2);
```

### 4. 表子查询

子查询的结果既包含很多条记录，又包含很多个列。
```sql
SELECT * FROM t1 WHERE (a, b, c, ...) IN (select a, b, c, ... FROM t2);
```

## 按与外层查询关系区分

### 1. 相关子查询

如果子查询的执行需要依赖于外层查询的值，这个子查询称之为相关子查询。
```sql
SELECT * FROM t1 WHERE a IN (SELECT a FROM t2 WHERE t1.a = t2.a);
```

### 2. 不相关子查询

如果子查询可以单独运行出结果，而不依赖于外层查询的值，这个子查询称之为不相关子查询。上面的几个子查询全部都可以看作不相关子查询。

---

# 子查询执行原理



---

# 子查询优化






